%script{:src => "https://www.amcharts.com/lib/3/amcharts.js"}
%script{:src => "https://www.amcharts.com/lib/3/serial.js"}
%script{:src => "https://www.amcharts.com/lib/3/themes/light.js"}
%script{:src => "https://www.amcharts.com/lib/3/amstock.js"}

.row
  .col-md-12
    %hr
    %button.btn.btn-primary.btn-sm{"data-target" => "#glucose", "data-toggle" => "modal", :type => "button"}
      Glucose
    %button.btn.btn-primary.btn-sm{"data-target" => "#hba1c_target", "data-toggle" => "modal", :type => "button"}
      Hba1c streefwaarde
    %button.btn.btn-primary.btn-sm{"data-target" => "#blood_pressure_target", "data-toggle" => "modal", :type => "button"}
      Bloeddruk streefwaarde
    %button.btn.btn-primary.btn-sm{"data-target" => "#heartrate_target", "data-toggle" => "modal", :type => "button"}
      Hartslag streefwaarde
    %button.btn.btn-primary.btn-sm{"data-target" => "#cholesterol_target", "data-toggle" => "modal", :type => "button"}
      Cholesterol streefwaarde

    %hr

#glucose.modal.fade{"aria-labelledby" => "myModalLabel", :role => "dialog", :tabindex => "-1"}
  = render 'forms/glucose.html.haml', glucose: @glucose

#hba1c_target.modal.fade{"aria-labelledby" => "hba1c_target", :role => "dialog", :tabindex => "-1"}
  = render 'forms/hba1c_target.html.haml', hba1c_target: @hba1c_target

#blood_pressure_target.modal.fade{"aria-labelledby" => "blood_pressure_target", :role => "dialog", :tabindex => "-1"}
  = render 'forms/blood_pressure_target.html.haml', blood_pressure_target: @blood_pressure_target

#heartrate_target.modal.fade{"aria-labelledby" => "heartrate_target", :role => "dialog", :tabindex => "-1"}
  = render 'forms/heartrate_target.html.haml', heartrate_target: @heartrate_target

#cholesterol_target.modal.fade{"aria-labelledby" => "cholesterol_target", :role => "dialog", :tabindex => "-1"}
  = render 'forms/cholesterol_target.html.haml', cholesterol_target: @cholesterol_target

.row
  .col-md-6
    .panel.panel-default
      .panel-body
        .row
          .col-md-2
            %a.thumbnail{:href => "#"}
              %img{:alt => "#{@client.name} #{@client.surname}", :src => "#{@client.photo_url}"}
          .col-md-5
            %h4
              = @client.name
              = @client.surname
            = @client.date_of_birth
            %br
            bloedgroep
            = @client.blood_type 
            %br
            Kamer 
            = @client.room
            %br
            Instelling 
            = @client.institution
.row
  .col-md-6
    .panel.panel-default
      .panel-body
        - @measures = []
        - @glucoses.each do |g| 
          - @measures << "{/date/: /#{g.activity_date.strftime('%Y-%m-%d %H:%M')}/, /value/: #{g.mmol} }"
          -if !@log.last
            - @measures << ","
        // Creating right format for Chart
        - @measures = @measures.to_s.gsub('"', '')
        - @measures = @measures.to_s.gsub('/', '"')
        = render 'diabetes/glucose_chart.html.haml'
        #chartdiv{ :style => "height: 500px"}
  .col-md-6
    .panel.panel-default
      .panel-body
        - @calender = []
        - @log.each do |l| 

          - @calender << "{title: '#{l.description}', start: '#{l.start_time.strftime('%Y-%m-%dT%H:%M')}', end: '#{l.end_time.strftime('%Y-%m-%dT%H:%M')}'   }"
          -if !@log.last
            - @calender << ","
        = render 'diabetes/log_calendar.html.haml'
        #calendar{ :style => "height: 500px"}
.row
  .col-md-6
    .panel.panel-default
      .panel-body
        = render 'diabetes/weight_chart.html.haml'
        #weight_chart{ :style => "height: 300px"}
  .col-md-6
    .panel.panel-default
      .panel-body
        = render 'diabetes/cholesterol_chart.html.haml'
        #cholesterol_chart{ :style => "height: 300px"}
.row
  .col-md-6
    Bloedsuikers
    %table.table.table-striped
      %tr
        %td id
        %td client id
        %td mmol
        %td datum
      - @glucoses.each do |g|
        %tr
          %td= g.id
          %td= g.client_id
          %td= g.mmol
          %td= g.activity_date
  .col-md-6
    .row
      .col-md-12
        HBA1C Streefwaarden
        %table.table.table-striped
          %tr
            %td id
            %td client id
            %td mmol
            %td datum
          - @hba1c_targets.each do |h|
            %tr
              %td= h.id
              %td= h.client_id
              %td= h.mmol
              %td= h.created_at
    .row
      .col-md-12
        Bloedddruk Streefwaarden
        %table.table.table-striped
          %tr
            %td id
            %td client id
            %td sys
            %td dia
            %td gemaakt op
          - @blood_pressure_targets.each do |b|
            %tr
              %td= b.id
              %td= b.client_id
              %td= b.sys
              %td= b.dia
              %td= b.created_at
    .row
      .col-md-12
        Hartslag Streefwaarden
        %table.table.table-striped
          %tr
            %td id
            %td client id
            %td hartslag
            %td gemaakt op
          - @heartrate_targets.each do |h|
            %tr
              %td= h.id
              %td= h.client_id
              %td= h.pulse
              %td= h.created_at
    .row
      .col-md-12
        Cholesterol Streefwaarden
        %table.table.table-striped
          %tr
            %td id
            %td client id
            %td ldl
            %td hdl
            %td gemaakt op
          - @cholesterol_targets.each do |c|
            %tr
              %td= c.id
              %td= c.client_id
              %td= c.ldl
              %td= c.hdl
              %td= c.created_at